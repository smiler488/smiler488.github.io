"use strict";(self.webpackChunkliangchao_website=self.webpackChunkliangchao_website||[]).push([[7683],{17921:(e,t,n)=>{function r(){const e="undefined"!=typeof window?window.localStorage.getItem("app_users"):null;if(!e)return[];try{return JSON.parse(e)||[]}catch{return[]}}function a(e){return Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join("")}async function i(e,t){const n=(new TextEncoder).encode(e),r=function(e){const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++)t[n]=parseInt(e.substr(2*n,2),16);return t.buffer}(t),i=await crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveBits"]);return a(await crypto.subtle.deriveBits({name:"PBKDF2",salt:r,iterations:15e4,hash:"SHA-256"},i,256))}async function s(e,t){const n=r();if(n.find((t=>t.email.toLowerCase()===String(e).toLowerCase())))throw new Error("Email already registered");const s=a(crypto.getRandomValues(new Uint8Array(16)).buffer),o=await i(t,s);return n.push({email:e,saltHex:s,hashHex:o,createdAt:(new Date).toISOString()}),function(e){"undefined"!=typeof window&&window.localStorage.setItem("app_users",JSON.stringify(e))}(n),d({email:e}),{email:e}}async function o(e,t){const n=r().find((t=>t.email.toLowerCase()===String(e).toLowerCase()));if(!n)throw new Error("Account not found");if(await i(t,n.saltHex)!==n.hashHex)throw new Error("Invalid credentials");return d({email:e}),{email:e}}function l(){if("undefined"==typeof window)return null;const e=window.localStorage.getItem("app_session");if(!e)return null;try{return JSON.parse(e)||null}catch{return null}}function d(e){"undefined"!=typeof window&&window.localStorage.setItem("app_session",JSON.stringify({email:e.email,at:Date.now()}))}function u(){"undefined"!=typeof window&&window.localStorage.removeItem("app_session")}n.d(t,{Ht:()=>l,iD:()=>o,kz:()=>s,ri:()=>u})},90611:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var r=n(96540),a=n(39495),i=n(17921),s=n(95082),o=n(74848);function l(){const[e,t]=(0,r.useState)(null),n=(0,i.Ht)(),[l,d]=(0,r.useState)(n||e?"profile":"login"),[u,c]=(0,r.useState)(""),[p,g]=(0,r.useState)(""),[f,h]=(0,r.useState)(""),[w,m]=(0,r.useState)("");return(0,r.useEffect)((()=>{const e=(0,s.b)();if(!e)return;e.auth.getUser().then((({data:e})=>{e?.user&&(t(e.user),d("profile"))}));const{data:n}=e.auth.onAuthStateChange(((e,n)=>{t(n?.user||null),n?.user&&d("profile")}));return()=>n?.subscription?.unsubscribe?.()}),[]),(0,o.jsx)(a.A,{title:"Account",children:(0,o.jsxs)("div",{className:"app-container",style:{maxWidth:560},children:[(0,o.jsxs)("div",{className:"app-header",style:{marginBottom:12},children:[(0,o.jsx)("h1",{className:"app-title",children:"Account"}),(0,o.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,o.jsx)("button",{className:"button button--secondary",onClick:()=>d("login"),children:"Login"}),(0,o.jsx)("button",{className:"button button--secondary",onClick:()=>d("register"),children:"Register"})]})]}),"login"===l&&(0,o.jsx)("div",{className:"app-card",children:(0,o.jsxs)("div",{style:{display:"grid",gap:12},children:[(0,o.jsx)("input",{type:"email",placeholder:"Email",value:u,onChange:e=>c(e.target.value),style:{padding:12,border:"1px solid var(--ifm-border-color)",borderRadius:8}}),(0,o.jsx)("input",{type:"password",placeholder:"Password",value:p,onChange:e=>g(e.target.value),style:{padding:12,border:"1px solid var(--ifm-border-color)",borderRadius:8}}),(0,o.jsx)("button",{className:"button button--primary",onClick:async function(){m("");const e=(0,s.b)();if(e){const{data:n,error:r}=await e.auth.signInWithPassword({email:u,password:p});return r?void m(r.message):(t(n.user),void d("profile"))}try{await(0,i.iD)(u,p),m("Logged in"),d("profile")}catch(n){m(String(n.message||n))}},children:"Login"})]})}),"register"===l&&(0,o.jsx)("div",{className:"app-card",children:(0,o.jsxs)("div",{style:{display:"grid",gap:12},children:[(0,o.jsx)("input",{type:"email",placeholder:"Email",value:u,onChange:e=>c(e.target.value),style:{padding:12,border:"1px solid var(--ifm-border-color)",borderRadius:8}}),(0,o.jsx)("input",{type:"password",placeholder:"Password",value:p,onChange:e=>g(e.target.value),style:{padding:12,border:"1px solid var(--ifm-border-color)",borderRadius:8}}),(0,o.jsx)("input",{type:"password",placeholder:"Confirm Password",value:f,onChange:e=>h(e.target.value),style:{padding:12,border:"1px solid var(--ifm-border-color)",borderRadius:8}}),(0,o.jsx)("button",{className:"button button--primary",onClick:async function(){if(m(""),!u||!p)return void m("Enter email and password");if(p!==f)return void m("Passwords do not match");const e=(0,s.b)();if(e){const{data:t,error:n}=await e.auth.signUp({email:u,password:p});return n?void m(n.message):void m("Registered. Please check your email to confirm.")}try{await(0,i.kz)(u,p),m("Registered and logged in"),d("profile")}catch(t){m(String(t.message||t))}},children:"Register"})]})}),"profile"===l&&(0,o.jsxs)("div",{className:"app-card",style:{display:"grid",gap:12},children:[(0,o.jsxs)("div",{children:["Signed in as ",e?.email||(0,i.Ht)()?.email]}),(0,o.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,o.jsx)("a",{className:"button button--secondary",href:"/app",children:"Go to Apps"}),(0,o.jsx)("button",{className:"button button--secondary",onClick:async function(){const e=(0,s.b)();e&&(await e.auth.signOut(),t(null)),(0,i.ri)(),d("login"),m("Logged out")},children:"Logout"})]})]}),w&&(0,o.jsx)("p",{className:"app-muted",style:{marginTop:12},children:w})]})})}},95082:(e,t,n)=>{n.d(t,{b:()=>i});var r=n(51270);let a=null;function i(){if(a)return a;if("undefined"==typeof window)return null;const e=window.__SUPABASE_URL__,t=window.__SUPABASE_ANON_KEY__;return e&&t?(a=(0,r.UU)(e,t,{auth:{persistSession:!0,autoRefreshToken:!0}}),a):null}}}]);