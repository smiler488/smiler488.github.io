"use strict";(self.webpackChunkliangchao_website=self.webpackChunkliangchao_website||[]).push([[3357],{17921:(e,t,r)=>{function n(){const e="undefined"!=typeof window?window.localStorage.getItem("app_users"):null;if(!e)return[];try{return JSON.parse(e)||[]}catch{return[]}}function a(e){return Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join("")}async function s(e,t){const r=(new TextEncoder).encode(e),n=function(e){const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++)t[r]=parseInt(e.substr(2*r,2),16);return t.buffer}(t),s=await crypto.subtle.importKey("raw",r,"PBKDF2",!1,["deriveBits"]);return a(await crypto.subtle.deriveBits({name:"PBKDF2",salt:n,iterations:15e4,hash:"SHA-256"},s,256))}async function o(e,t){const r=n();if(r.find((t=>t.email.toLowerCase()===String(e).toLowerCase())))throw new Error("Email already registered");const o=a(crypto.getRandomValues(new Uint8Array(16)).buffer),i=await s(t,o);return r.push({email:e,saltHex:o,hashHex:i,createdAt:(new Date).toISOString()}),function(e){"undefined"!=typeof window&&window.localStorage.setItem("app_users",JSON.stringify(e))}(r),c({email:e}),{email:e}}async function i(e,t){const r=n().find((t=>t.email.toLowerCase()===String(e).toLowerCase()));if(!r)throw new Error("Account not found");if(await s(t,r.saltHex)!==r.hashHex)throw new Error("Invalid credentials");return c({email:e}),{email:e}}function l(){if("undefined"==typeof window)return null;const e=window.localStorage.getItem("app_session");if(!e)return null;try{return JSON.parse(e)||null}catch{return null}}function c(e){"undefined"!=typeof window&&window.localStorage.setItem("app_session",JSON.stringify({email:e.email,at:Date.now()}))}function u(){"undefined"!=typeof window&&window.localStorage.removeItem("app_session")}r.d(t,{Ht:()=>l,iD:()=>i,kz:()=>o,ri:()=>u})},34619:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(96540),a=r(17921),s=r(95082),o=r(74848);function i({children:e}){const[t,r]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{const e=(0,s.b)();if(e){e.auth.getUser().then((({data:e})=>{const t=!!e?.user;r(t),"undefined"!=typeof window&&(window.__APP_AUTH_OK__=t)}));const{data:t}=e.auth.onAuthStateChange(((e,t)=>{const n=!!t?.user;r(n),"undefined"!=typeof window&&(window.__APP_AUTH_OK__=n)}));return()=>t?.subscription?.unsubscribe?.()}const t=!!(0,a.Ht)();r(t),"undefined"!=typeof window&&(window.__APP_AUTH_OK__=t)}),[]),(0,o.jsxs)("div",{children:[!t&&(0,o.jsx)("div",{className:"app-card",style:{marginBottom:12},children:(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)("span",{className:"app-muted",children:"Please login to use app features"}),(0,o.jsx)("a",{className:"button button--secondary",href:"/auth",children:"Login / Register"})]})}),e]})}},62835:(e,t,r)=>{r.d(t,{A:()=>d});var n=r(96540),a=r(74848);const s={maxWidth:"800px",margin:"60px auto 0",textAlign:"left",padding:"0 20px"},o={fontSize:"2rem",fontWeight:"600",marginBottom:"16px",color:"#000000"},i={fontSize:"1.1rem",color:"#333333",lineHeight:1.6,marginBottom:"16px"},l={borderLeft:"4px solid #cccccc",paddingLeft:"16px",color:"#333333",fontStyle:"italic",lineHeight:1.6,marginBottom:"16px"},c={backgroundColor:"#f6f6f7",padding:"16px",borderRadius:"12px",overflowX:"auto",border:"1px solid #e5e5e7"},u={fontSize:"1.5rem",fontWeight:"600",marginBottom:"16px",color:"#000000"};function d({containerStyle:e}){const[t,r]=(0,n.useState)(!1),[d,p]=(0,n.useState)(!1),m="LiangchaoDeng. (2025). smiler488/smiler488.github.io: Digital Plant Phenotyping Platform v25.0 (v25.0.0). Zenodo. https://doi.org/10.5281/zenodo.17544584",h="@software{Deng2025_DPPP_v25,\n  author       = {Deng, Liangchao},\n  title        = {Digital Plant Phenotyping Platform (v25.0)},\n  year         = {2025},\n  publisher    = {Zenodo},\n  doi          = {10.5281/zenodo.17544584},\n  url          = {https://doi.org/10.5281/zenodo.17544584},\n  note         = {[Computer software]}\n}";return(0,a.jsxs)("div",{style:{...s,...e},children:[(0,a.jsx)("h2",{style:o,children:"Citation"}),(0,a.jsxs)("p",{style:i,children:["If you use ",(0,a.jsx)("strong",{children:"Digital Plant Phenotyping Platform v25.0"})," or any of its applications in your research, please cite it as:"]}),(0,a.jsxs)("blockquote",{style:l,children:["LiangchaoDeng. (2025)."," ",(0,a.jsx)("em",{children:"smiler488/smiler488.github.io: Digital Plant Phenotyping Platform v25.0 (v25.0.0)"}),". Zenodo.",(0,a.jsx)("br",{}),(0,a.jsx)("a",{href:"https://doi.org/10.5281/zenodo.17544584",children:"https://doi.org/10.5281/zenodo.17544584"})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px",gap:"12px"},children:[(0,a.jsx)("button",{type:"button",onClick:async()=>{try{if("undefined"!=typeof navigator&&navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(m);else if("undefined"!=typeof document){const e=document.createElement("textarea");e.value=m,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}r(!0),setTimeout((()=>r(!1)),2e3)}catch{r(!1)}},style:{padding:"8px 16px",borderRadius:"8px",border:"1px solid #000000",backgroundColor:"#000000",color:"#ffffff",cursor:"pointer",fontSize:"0.95rem",fontWeight:500,transition:"transform 0.15s ease, background-color 0.15s ease"},onMouseOver:e=>{e.currentTarget.style.backgroundColor="#333333",e.currentTarget.style.transform="translateY(-1px)"},onMouseOut:e=>{e.currentTarget.style.backgroundColor="#000000",e.currentTarget.style.transform="translateY(0)"},children:t?"Copied!":"Copy citation"}),(0,a.jsx)("span",{style:{fontSize:"0.9rem",color:t?"#007f5f":"#6c6c70"},children:t?"Citation copied to clipboard.":"Click to copy APA citation."})]}),(0,a.jsx)("a",{href:"https://doi.org/10.5281/zenodo.17544584",style:{display:"inline-block",marginBottom:"24px"},children:(0,a.jsx)("img",{src:"https://zenodo.org/badge/DOI/10.5281/zenodo.17544584.svg",alt:"DOI badge",style:{height:"32px"}})}),(0,a.jsx)("hr",{style:{border:"none",borderTop:"1px solid #e5e5e7",marginBottom:"24px"}}),(0,a.jsx)("h3",{style:u,children:"BibTeX citation (Zotero \u2192 File \u2192 Import from Clipboard)"}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px",gap:"12px"},children:[(0,a.jsx)("button",{type:"button",onClick:async()=>{try{if("undefined"!=typeof navigator&&navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(h);else if("undefined"!=typeof document){const e=document.createElement("textarea");e.value=h,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}p(!0),setTimeout((()=>p(!1)),2e3)}catch{p(!1)}},style:{padding:"8px 16px",borderRadius:"8px",border:"1px solid #000000",backgroundColor:"#000000",color:"#ffffff",cursor:"pointer",fontSize:"0.95rem",fontWeight:500,transition:"transform 0.15s ease, background-color 0.15s ease"},onMouseOver:e=>{e.currentTarget.style.backgroundColor="#333333",e.currentTarget.style.transform="translateY(-1px)"},onMouseOut:e=>{e.currentTarget.style.backgroundColor="#000000",e.currentTarget.style.transform="translateY(0)"},children:d?"Copied!":"Copy BibTeX"}),(0,a.jsx)("span",{style:{fontSize:"0.9rem",color:d?"#007f5f":"#6c6c70"},children:d?"BibTeX copied to clipboard. Switch to Zotero and choose Import from Clipboard.":"Click to copy BibTeX to clipboard for Zotero import."})]}),(0,a.jsx)("pre",{style:c,children:(0,a.jsx)("code",{children:h})})]})}},74911:(e,t,r)=>{r.d(t,{B2:()=>l,S:()=>s,dO:()=>i,kh:()=>n,lJ:()=>o,wn:()=>a});const n="https://api.hunyuan.cloud.tencent.com/v1/chat/completions",a="sk-JdwAvFcfyW5ngP2i3cpeB43QrR92gjnRcNzKkMfpcEVu8hlE";function s(){return n}function o(e,t){return{model:t||"hunyuan-lite",messages:[{role:"user",content:[{type:"text",text:(e||"").trim()||"You are a helpful assistant that generates ECharts option JSON based on CSV summaries."}]}],stream:!1}}function i(e){return Array.isArray(e?.choices)&&e.choices.length>0?e.choices[0].message?.content||"":e?.Response&&Array.isArray(e.Response.Choices)&&e.Response.Choices.length>0?e.Response.Choices[0].Message?.Content||"":"string"==typeof e?e:JSON.stringify(e,null,2)}async function l(e,t,r={}){if("string"==typeof e&&e.startsWith("mock://")){const r=e.slice(7);if("ai-data-visualizer"===r){const e={summary:"Sample analysis: sales grew steadily across quarters, with Q4 showing the highest revenue. Seasonal dips occur in Q2 due to inventory resets.",insights:["Strong upward trend overall; expect ~12% YoY growth.","Product beta overtook alpha in Q3 and maintained the lead.","Recommend stacked area chart to communicate contribution per product."],chart_option:{title:{text:"Mock Revenue Correlation Heatmap",left:"center"},tooltip:{position:"top"},grid:{left:"5%",right:"5%",top:"12%",bottom:"18%"},xAxis:{type:"category",data:["North","South","East","West"],splitArea:{show:!0}},yAxis:{type:"category",data:["Q1","Q2","Q3","Q4"],splitArea:{show:!0}},visualMap:{min:60,max:210,calculable:!0,orient:"horizontal",left:"center",bottom:"4%"},series:[{name:"Revenue",type:"heatmap",label:{show:!0},data:[[0,0,120],[1,0,135],[2,0,150],[3,0,110],[0,1,98],[1,1,142],[2,1,160],[3,1,100],[0,2,160],[1,2,175],[2,2,182],[3,2,138],[0,3,190],[1,3,205],[2,3,210],[3,3,168]]}]}},t={choices:[{message:{content:JSON.stringify(e,null,2)}}]};return{ok:!0,status:200,json:async()=>t,text:async()=>JSON.stringify(t),headers:new Map([["content-type","application/json"]])}}if("journal-selector"===r){const e={overview:{abstract_summary:t?.question?.slice(0,120)||"N/A",alignment_summary:"Mocked response (replace API URL for real results)."},journals:[{journal_name:"Mock Journal of AI",publisher:"Mock Press",discipline_scope:"AI & Data Science",impact_factor_2024:"8.5",jcr_quartile:"Q1",acceptance_rate:"18%",initial_review_weeks:6,oa_type:"Hybrid OA",apc_usd:2400,submission_advice:"Strong alignment with ML/DS topics.",warning_status:"-"}],notes:"This is a mock response generated locally."},r={choices:[{message:{content:JSON.stringify(e,null,2)}}]};return{ok:!0,status:200,json:async()=>r,text:async()=>JSON.stringify(r),headers:new Map([["content-type","application/json"]])}}if("ai-solver"===r){const e=(new Date).toISOString(),r=t?.question||"No question provided",n=t?.model||"hunyuan-lite",a=`${!!t?.imageBase64||!!t?.imageUrl?"Mock Vision Analysis":"Mock Text Analysis"} (model: ${n})\n\nUser question:\n${r}\n\nThis is a mocked response for demo purposes. Replace proxy URL with your real API when ready.`,s={Response:{RequestId:"mock-"+Math.random().toString(36).slice(2),Choices:[{Message:{Content:a}}],Usage:{PromptTokens:128,CompletionTokens:256,TotalTokens:384},Timestamp:e}};return{ok:!0,status:200,json:async()=>s,text:async()=>JSON.stringify(s),headers:new Map([["content-type","application/json"]])}}}return fetch(e,{method:"POST",headers:{"Content-Type":"application/json",...r},body:JSON.stringify(t)})}},77353:(e,t,r)=>{r.r(t),r.d(t,{default:()=>C});var n=r(96540),a=r(63018),s=r(34619),o=r(62835),i=r(74911),l=r(74848);const c=40,u=8e3,d=["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc948","#b07aa1","#ff9da7","#9c755f","#bab0ab"],p={doughnut:"pie",donut:"pie",area:"line",stackedarea:"line",horizontalbar:"bar",verticalbar:"bar"},m=["line","bar","scatter","pie","radar","heatmap","funnel","gauge","treemap","sankey","boxplot"],h="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js";let g=null;function y(e){if(!e)return null;const t=function(e){if(!e)return"";let t=e.trim();return t.startsWith("```")&&(t=t.replace(/^```(?:json)?/i,"").replace(/```$/,"").trim()),t}(e);try{return JSON.parse(t)}catch{const e=f(t);if(e)try{return JSON.parse(e)}catch{}const r=function(e){if(!e)return null;const t=String(e);let r=!1,n=!1,a=0,s=-1;for(let o=0;o<t.length;o+=1){const e=t[o];if(r)n?n=!1:"\\"===e?n=!0:'"'===e&&(r=!1);else if('"'!==e)if("{"!==e){if("}"===e&&a>0&&(a-=1,0===a&&-1!==s))return t.slice(s,o+1)}else 0===a&&(s=o),a+=1;else r=!0,n=!1}return null}(t);if(r)try{return JSON.parse(r)}catch{const e=f(r);if(e)try{return JSON.parse(e)}catch{}}return null}}function f(e){if(!e)return null;let t=e;t=t.replace(/[\u201C\u201D]/g,'"').replace(/[\u2018\u2019]/g,"'").replace(/\bTrue\b/g,"true").replace(/\bFalse\b/g,"false").replace(/\bNone\b/g,"null"),t=t.replace(/(^|\n)\s*```(?:json)?[\s\S]*?\n/g,""),t=t.replace(/(^|\n)\s*```\s*$/g,""),t=t.replace(/(^|\n)\s*Response:?/gi,"$1"),t=t.replace(/([{,\s])'([^'"]+?)'\s*:/g,'$1"$2":'),t=t.replace(/:\s*'([^'"]*?)'/g,':"$1"'),t=t.replace(/,\s*([}\]])/g,"$1");const r=(t.match(/{/g)||[]).length-(t.match(/}/g)||[]).length;return r>0?t+="}".repeat(r):r<0&&(t=t.replace(/}{1,}$/,"")),t}function x(e,t){if(!e&&""!==e)return[];const r=[];let n="",a=!1;for(let s=0;s<e.length;s+=1){const o=e[s];'"'!==o?a||o!==t?n+=o:(r.push(n.trim()),n=""):a&&'"'===e[s+1]?(n+='"',s+=1):a=!a}return r.push(n.trim()),r.map((e=>e.replace(/^"|"$/g,"")))}function b(e){if(!e)return null;const t=e.replace(/\r\n/g,"\n").trim();if(!t)return null;const r=t.split("\n").filter((e=>e.trim().length>0));if(0===r.length)return null;const n=function(e){const t=Array.isArray(e)?e.join("\n"):e||"";return t.includes("\t")?"\t":(t.match(/,/g)||[]).length>=(t.match(/;/g)||[]).length?",":";"}([r[0],r[1]||""]),a=x(r[0],n).map(((e,t)=>e&&e.trim()?e.trim():`Column ${t+1}`)),s=[],o=a.map((()=>new Map));for(let d=1;d<r.length;d+=1){const e=x(r[d],n),t={};a.forEach(((r,n)=>{const a=void 0!==e[n]?e[n].trim():"";if(t[r]=a,a&&a.length>0){const e=o[n];e.set(a,(e.get(a)||0)+1)}})),s.length<c&&s.push(t)}const i=a.map((e=>{const t=s.map((t=>t[e])).filter((e=>function(e){if(null==e)return!1;const t=String(e).trim();if(!t)return!1;const r=t.replace(/,/g,"");return!Number.isNaN(Number(r))}(e))).length;return(s.length>0?t/s.length:0)>=.6?e:null})).filter(Boolean),l=a.reduce(((e,t,r)=>{const n=o[r],a=Array.from(n.entries()).sort(((e,t)=>t[1]-e[1])).slice(0,8).map((([e,t])=>({value:e,count:t})));return e[t]={unique_count:n.size,top_values:a},e}),{}),u=a.map(((e,t)=>({header:e,idx:t}))).filter((({header:e})=>!i.includes(e))).flatMap((({idx:e})=>(l[a[e]]?.top_values||[]).map((e=>e.value)))).filter(((e,t,r)=>e&&r.indexOf(e)===t)).slice(0,40);return{headers:a,sampleRows:s,delimiter:n,rowCount:Math.max(r.length-1,s.length),numericHints:i,valueStats:l,categoryHints:u}}function w(e,t={}){if(!e||"object"!=typeof e)return null;const r={color:Array.isArray(e.color)&&e.color.length>0?e.color:d,tooltip:e.tooltip||{trigger:"axis"},...e},n={xCategories:null,yCategories:null,min:1/0,max:-1/0},a=new Set;t&&"object"==typeof t&&(t.letters&&"object"==typeof t.letters&&Object.keys(t.letters).forEach((e=>{null!=e&&a.add(String(e))})),Array.isArray(t.errorBars)&&t.errorBars.forEach((e=>{e&&void 0!==e.name&&null!==e.name&&a.add(String(e.name))})),Array.isArray(t.categoryHints)&&t.categoryHints.forEach((e=>{null!=e&&a.add(String(e))})));const s=Array.isArray(r.series)?r.series:r.series?[r.series]:[];if(0===s.length)return null;r.series=s.map(((e,t)=>{const r=A(e.type,0===t?"line":e.type);let a={name:e.name||e.label||`Series ${t+1}`,...e,type:r};if("pie"!==r||a.radius||(a.radius=["40%","70%"]),"heatmap"===r){const e=function(e){const t=Array.isArray(e)?e:[],r=new Map,n=new Map,a=[],s=[],o=[];let i=1/0,l=-1/0;const c=(e,t,r)=>{if(null==e)return null;if("number"==typeof e&&Number.isFinite(e))return e;const n=String(e);if(t.has(n))return t.get(n);const a=r.length;return r.push(n),t.set(n,a),a};return t.forEach((e=>{let t,u,d;if(Array.isArray(e)&&e.length>=3)[t,u,d]=e;else{if(!e||"object"!=typeof e)return;t=e.x??e.col??e.column??e.column_name??e.columnName??e.i??e.j,u=e.y??e.row??e.index??e.row_name??e.rowName??e.k??e.l,d=e.value??e.v??e.score??e.z??e.correlation}if(null==d||Number.isNaN(Number(d)))return;const p=Number(d),m=c(t,r,a),h=c(u,n,s);null!=m&&null!=h&&(o.push([Number(m),Number(h),p]),p<i&&(i=p),p>l&&(l=p))})),{data:o,xCategories:a.length>0?a:null,yCategories:s.length>0?s:null,valueRange:o.length>0?{min:i,max:l}:null}}(a.data);a={...a,data:e.data},a.label||(a.label={show:e.data.length<=250}),a.emphasis||(a.emphasis={itemStyle:{shadowBlur:10,shadowColor:"rgba(0,0,0,0.4)"}}),e.xCategories&&!n.xCategories&&(n.xCategories=e.xCategories),e.yCategories&&!n.yCategories&&(n.yCategories=e.yCategories),e.valueRange&&(n.min=Math.min(n.min,e.valueRange.min),n.max=Math.max(n.max,e.valueRange.max))}return a})),!r.legend&&r.series.some((e=>!!e.name))&&(r.legend={top:"bottom"});r.series.some((e=>!["pie","funnel","gauge","treemap","sankey"].includes(e.type)))&&!r.grid&&(r.grid={left:"6%",right:"4%",top:"8%",bottom:"10%",containLabel:!0});const o=a.size>0?Array.from(a):null;return n.xCategories?r.xAxis=j(r.xAxis,n.xCategories):o&&(r.xAxis=j(r.xAxis,o,{merge:!0})),n.yCategories&&(r.yAxis=j(r.yAxis,n.yCategories)),n.min===1/0||void 0!==r.visualMap&&null!==r.visualMap||(r.visualMap={min:n.min,max:n.max,calculable:!0,orient:"horizontal",left:"center",bottom:"5%"}),Array.isArray(r.series)&&(r.series=r.series.filter((e=>{const t=e&&(e.name||e.label)?String(e.name||e.label).toLowerCase():"";return!/standard\s*error|std\s*error|\bse\b/.test(t)}))),r}function v(e){if(!e||"object"!=typeof e)return null;const t=e.data||e.chartData;if(!t)return null;const r=Array.isArray(t.datasets)?t.datasets:[],n=Array.isArray(t.labels)?t.labels:Array.from({length:r[0]?.data?.length||0},((e,t)=>`Item ${t+1}`)),a=A(e.type||e.chartType,1===r.length?"line":"bar");return"pie"===a?function(e,t){const r=t[0]?.data||[],n=e.map(((e,t)=>({name:e||`Slice ${t+1}`,value:r[t]??0})));return{color:d,tooltip:{trigger:"item"},legend:{top:"bottom"},series:[{type:"pie",radius:["40%","70%"],data:n,emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.2)"}}}]}}(n,r):function(e,t,r,n={}){const a="y"===n?.indexAxis,s=a?"yAxis":"xAxis",o=a?"xAxis":"yAxis";return{color:d,tooltip:{trigger:"axis"},legend:{top:"bottom"},grid:{left:"4%",right:"3%",bottom:"8%",containLabel:!0},[s]:{type:"category",data:t},[o]:{type:"value"},series:r.map(((t,r)=>({name:t.label||`Series ${r+1}`,type:e,smooth:"line"===e,data:t.data||[],emphasis:{focus:"series"}})))}}(a,n,r,e.options)}function A(e,t="line"){const r="string"==typeof e?e.toLowerCase().trim():"",n=p[r]||r;return n&&m.includes(n)?n:t}function j(e,t,{merge:r=!1}={}){if(!t||0===t.length)return e||{type:"category"};if(Array.isArray(e)){const n=e.length>0?e.map((e=>({...e}))):[{}];return n[0]?(n[0].type||(n[0].type="category"),n[0].data&&0!==n[0].data.length?r&&(n[0].data=S(n[0].data,t)):n[0].data=t):n[0]={type:"category",data:t},n}const n=e&&"object"==typeof e?{...e}:{type:"category"};return n.type||(n.type="category"),n.data&&0!==n.data.length?r&&(n.data=S(n.data,t)):n.data=t,n}function S(e,t){const r=Array.isArray(e)?e.map((e=>null!=e?String(e):e)):[],n=new Set(r);return t.forEach((e=>{const t=null!=e?String(e):e;null==t||n.has(t)||(r.push(e),n.add(t))})),r}function C(){const e=(0,n.useMemo)(i.S,[]),[t,r]=(0,n.useState)(!0),[d,p]=(0,n.useState)(""),[m,f]=(0,n.useState)(""),[x,A]=(0,n.useState)("hunyuan-lite"),[j,S]=(0,n.useState)("Highlight the clearest trend, choose the best chart for stakeholders, and annotate anomalies."),[C,_]=(0,n.useState)(null),[k,N]=(0,n.useState)(""),[T,z]=(0,n.useState)("Upload a CSV/TSV to get started."),[I,O]=(0,n.useState)(!1),[P,E]=(0,n.useState)(""),[M,R]=(0,n.useState)([]),[B,H]=(0,n.useState)(null),[L,D]=(0,n.useState)(""),[J,U]=(0,n.useState)(""),$=(0,n.useRef)(null),F=(0,n.useRef)(null),[q,V]=(0,n.useState)(!1),[W,K]=(0,n.useState)(""),Y=(0,n.useMemo)((()=>b(k)),[k]),Q=(0,n.useMemo)((()=>function(e,t){if(!t)return"";const r={file:e?{name:e.name,size:e.size,type:e.type}:null,stats:{estimated_rows:t.rowCount,column_count:t.headers.length,delimiter:"\t"===t.delimiter?"tab":t.delimiter,mostly_numeric_columns:t.numericHints,category_hint_examples:t.categoryHints||[]},columns:t.headers,sample_rows:t.sampleRows.slice(0,8),column_profiles:t.headers.map((e=>({name:e,mostly_numeric:t.numericHints.includes(e),unique_values:t.valueStats?.[e]?.unique_count??0,top_values:(t.valueStats?.[e]?.top_values||[]).slice(0,5)})))};let n=JSON.stringify(r,null,2);return n.length>u&&(n=`${n.slice(0,u)}\n... (truncated for token safety)`),n}(C,Y)),[C,Y]);async function X(e){U(e);const t=y(e);if(!t)throw new Error("AI response was not valid JSON. Ask it to follow the schema.");E(t.summary||"AI did not return a summary."),R(Array.isArray(t.insights)?t.insights:[]);const r=t&&(t.tukey_letters||t.tukeyLetters||t.letters||t.annotations_letters)||null;let n=w(t.chart_option||t.chartOption||t.option||v(t.chart_config||t.chartConfig),{letters:r,errorBars:t.error_bars,categoryHints:Y?.categoryHints||[]});n?(Array.isArray(t.error_bars)&&t.error_bars.length>0&&(n=function(e,t){try{if(!e||!Array.isArray(t)||0===t.length)return e;const r=Array.isArray(e.xAxis)?e.xAxis[0]:e.xAxis,n=Array.isArray(e.yAxis)?e.yAxis[0]:e.yAxis,a=r&&Array.isArray(r.data)?r.data:null,s=Array.isArray(e.series)&&e.series[0]&&"bar"===String(e.series[0].type).toLowerCase()&&(!r||"category"===r.type)&&(!n||"category"!==n.type);if(!a||!s)return e;const o=new Map((a||[]).map(((e,t)=>[String(e),t]))),i=[];for(const e of t){if(!e||null==e.low||null==e.high||null==e.name)continue;const t=o.get(String(e.name));if(null==t)continue;const r=Number(e.low),n=Number(e.high);Number.isFinite(r)&&Number.isFinite(n)&&i.push([t,r,n])}if(0===i.length)return e;const l={name:"SE whiskers",type:"custom",tooltip:{show:!1},renderItem:function(e,t){if(!t||"function"!=typeof t.coord||"function"!=typeof t.value)return null;const r=t.value(0),n=t.value(1),a=t.value(2);if(!Number.isFinite(r)||!Number.isFinite(n)||!Number.isFinite(a))return null;const s=t.coord([r,0]),o=t.coord([r,n]),i=t.coord([r,a]);if(!s||!o||!i)return null;const l=s[0],c=o[1],u=i[1],d="function"==typeof t.size?t.size([1,0])[0]:10,p=Math.max(6,Math.min(12,.25*d||8)),m=t.style({stroke:"#333",fill:null,lineWidth:1.2});return{type:"group",children:[{type:"line",shape:{x1:l,y1:c,x2:l,y2:u},style:m},{type:"line",shape:{x1:l-p,y1:c,x2:l+p,y2:c},style:m},{type:"line",shape:{x1:l-p,y1:u,x2:l+p,y2:u},style:m}]}},encode:{x:0,y:[1,2]},z:10,data:i};return{...e,series:Array.isArray(e.series)?[...e.series,l]:[l]}}catch(r){return e}}(n,t.error_bars)),r&&"object"==typeof r&&(n=function(e,t){try{if(!e||!t||"object"!=typeof t)return e;if(0===Object.keys(t).length)return e;const r=Array.isArray(e.series)?e.series.map((e=>({...e}))):[];if(0===r.length)return e;const n=r.findIndex((e=>"bar"===String(e?.type||"").toLowerCase()));if(-1===n)return e;const a={...r[n]},s=a.label||{};return a.label={show:!0,position:"top",color:"#111",fontSize:14,fontWeight:"600",backgroundColor:"rgba(255,255,255,0.0)",padding:[0,0,4,0],offset:[0,-4],...s,formatter:e=>t&&t[e.name]||""},delete a.markPoint,delete a.markLine,r[n]=a,{...e,series:r}}catch(r){return e}}(n,r)),H(n)):D("AI response missing a valid chart_option; please retry with clearer instructions.")}return(0,n.useEffect)((()=>{let e=!1;return async function(){if($.current&&B){K("");try{const t=await("undefined"==typeof window?Promise.resolve(null):window.echarts?Promise.resolve(window.echarts):g||(g=new Promise(((e,t)=>{const r=document.querySelector('script[data-echarts-loader="true"]');if(r)return window.echarts?void e(window.echarts):(r.addEventListener("load",(()=>e(window.echarts))),void r.addEventListener("error",(e=>t(e))));const n=document.createElement("script");n.src=h,n.async=!0,n.dataset.echartsLoader="true",n.onload=()=>e(window.echarts),n.onerror=e=>t(e||new Error("Failed to load ECharts script.")),document.body.appendChild(n)})),g));if(!t||!$.current||e)return;F.current||(F.current=t.init($.current)),F.current.setOption(B,!0),F.current.resize(),V(!0)}catch(t){K(t?.message||"Chart rendering failed."),V(!1)}}else V(!1)}(),()=>{e=!0,F.current&&(F.current.dispose(),F.current=null)}}),[B]),(0,n.useEffect)((()=>{if("undefined"==typeof window)return;const e=()=>{F.current&&F.current.resize()};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,l.jsx)(a.A,{title:"AI Data Visualizer",children:(0,l.jsxs)("main",{className:"container margin-vert--lg app-container",children:[(0,l.jsx)("div",{className:"row",children:(0,l.jsxs)("div",{className:"col col--12",children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,l.jsx)("h1",{children:"AI Data Visualizer"}),(0,l.jsx)("a",{className:"button button--secondary",href:"/docs/tutorial-apps/ai-data-visualizer-tutorial",children:"Tutorial"})]}),(0,l.jsx)(s.A,{}),(0,l.jsx)("p",{children:"Upload a CSV/TSV file, describe what you want to learn, and let the AI suggest an interactive ECharts visualization plus insights. No backend storage \u2014 everything runs in your browser."})]})}),(0,l.jsxs)("div",{className:"row",children:[(0,l.jsxs)("div",{className:"col col--4",children:[(0,l.jsxs)("section",{className:"card padding--md margin-bottom--lg",children:[(0,l.jsx)("h3",{children:"1. Upload data"}),(0,l.jsx)("input",{type:"file",accept:".csv,.tsv,text/csv,text/tab-separated-values",onChange:function(e){const t=e.target.files&&e.target.files[0];if(!t)return _(null),void N("");_({name:t.name,size:t.size,type:t.type||"text/csv"}),z("Reading file\u2026");const r=new FileReader;r.onload=e=>{const t=e.target?.result||"";N(t),z("File ready. Configure the analysis prompt.")},r.onerror=()=>{z("Failed to read file. Please try again.")},r.readAsText(t)}}),C&&(0,l.jsxs)("p",{className:"margin-top--sm",children:[(0,l.jsx)("strong",{children:"File:"})," ",C.name," (",(C.size/1024).toFixed(1)," KB)"]}),(0,l.jsx)("p",{className:"margin-top--sm",children:T})]}),(0,l.jsxs)("section",{className:"card padding--md margin-bottom--lg",children:[(0,l.jsx)("h3",{children:"2. Analysis goal"}),(0,l.jsx)("textarea",{value:j,onChange:e=>S(e.target.value),rows:6,style:{width:"100%"},placeholder:"Tell the AI what kind of pattern or story to highlight."}),(0,l.jsx)("button",{className:"button button--primary margin-top--md",onClick:async function(){if(Y){O(!0),z("Building prompt\u2026"),D(""),K(""),U(""),E(""),R([]),H(null),V(!1);try{const r=function({datasetSummary:e,goal:t}){const r=e&&e.length>0?e:"Dataset summary missing. Ask the user for data.";return["You are an expert data scientist that returns high quality **ECharts** visualizations.","Instructions:","- Use the dataset summary below (tabular, tidy rows).","- Choose the most expressive chart type supported by Apache ECharts (line, bar, scatter, pie, radar, heatmap, sankey, etc.). Heatmaps are encouraged for correlation matrices.","- Respond with strict JSON only. Start with { and end with }. No Markdown or explanations:","  {",'    "summary": "<2-3 sentence natural-language overview>",','    "insights": ["<bullet insight 1>", "<bullet insight 2>", "..."],','    "chart_option": { /* valid ECharts option */ }',"  }","- The `chart_option` must be a valid ECharts option object (title/tooltip/grid/xAxis/yAxis/visualMap/series/etc).","- Include axes labels, legends, tooltips, and visualMap (when using heatmap or continuous color scales).","- Keep series arrays short (<=6) and align data lengths with category axes.","- Never include functions or comments in the JSON.",'- If the goal mentions ANOVA/Tukey or group letters, return an additional field `tukey_letters` as a JSON object mapping each category name (x-axis label) to its letter(s), e.g., {"Treatment_A":"a","Treatment_B":"ab"}.','- Do NOT create a second series for Standard Error. If uncertainty must be represented, return an `error_bars` array like [{"name":"Treatment_A","low":2450,"high":2550}] and the app will render whiskers; letters must be TEXT labels only.',"- If the goal requests a correlation heatmap, build a rectangular heatmap using [xIndex, yIndex, value] tuples.",`User goal: ${t&&t.trim().length>0?t.trim():"Highlight the most actionable trend and propose the best chart."}`,"Dataset summary (JSON):",r].join("\n")}({datasetSummary:Q||"No dataset summary available.",goal:j}),n=t?e:d&&d.trim()&&/^https?:\/\//.test(d.trim())?d.trim():"mock://ai-data-visualizer",a=n===e;z("Calling AI\u2026");let s={question:r,model:x},o={};if(n===i.kh)s=(0,i.lJ)(r,x),o={Authorization:`Bearer ${i.wn}`};else if(!t&&m.trim()){const e=m.trim();o={Authorization:e.toLowerCase().startsWith("bearer ")?e:`Bearer ${e}`},s.response_format={type:"json_object"}}const l=await(0,i.B2)(n,s,o);if(!l.ok){const e=await l.text().catch((()=>""));if(a&&[403,404,405].includes(l.status)){const e=await(0,i.B2)("mock://ai-data-visualizer",s),t=await e.json(),r=(0,i.dO)(t);return await X(r),void z("Mock response shown (default endpoint unavailable).")}throw new Error(e||`API call failed (${l.status})`)}const c=await l.json().catch((async()=>({raw:await l.text()}))),u=(0,i.dO)(c);await X(u),z("Visualization ready!")}catch(r){D(r?.message||"AI call failed."),z("Analysis failed.")}finally{O(!1)}}else z("Please upload a CSV or TSV file first.")},disabled:I||!Y||"undefined"!=typeof window&&!window.__APP_AUTH_OK__,children:I?"Analyzing\u2026":"Generate visualization"}),(0,l.jsxs)("div",{className:"margin-top--lg",style:{fontSize:"0.9rem"},children:[(0,l.jsxs)("label",{style:{display:"flex",gap:"0.4rem",alignItems:"center"},children:[(0,l.jsx)("input",{type:"checkbox",checked:t,onChange:e=>r(e.target.checked)}),"Use built-in HunYuan endpoint"]}),!t&&(0,l.jsxs)("div",{className:"margin-top--sm",children:[(0,l.jsxs)("label",{htmlFor:"custom-api-url",children:["API URL",(0,l.jsx)("input",{id:"custom-api-url",type:"text",value:d,onChange:e=>p(e.target.value),style:{width:"100%",marginTop:"0.3rem"},placeholder:"https://your-proxy-endpoint/v1/chat/completions"})]}),(0,l.jsxs)("label",{htmlFor:"custom-api-key",className:"margin-top--sm",style:{display:"block"},children:["Bearer token",(0,l.jsx)("input",{id:"custom-api-key",type:"password",value:m,onChange:e=>f(e.target.value),style:{width:"100%",marginTop:"0.3rem"},placeholder:"sk-..."})]}),(0,l.jsx)("p",{style:{fontSize:"0.8rem",marginTop:"0.4rem"},children:"Custom keys stay in your browser only. Leave blank to hit the mock endpoint."})]})]})]}),(0,l.jsxs)("section",{className:"card padding--md",children:[(0,l.jsx)("h3",{children:"Dataset summary sent to AI"}),(0,l.jsx)("textarea",{value:Q,readOnly:!0,rows:16,style:{width:"100%",fontFamily:"monospace"}})]})]}),(0,l.jsxs)("div",{className:"col col--8",children:[(0,l.jsxs)("section",{className:"card padding--md margin-bottom--lg",children:[(0,l.jsxs)("h3",{children:["Preview (first ",Math.min(c,Y?.sampleRows?.length||0)," rows)"]}),Y?(0,l.jsx)("div",{style:{overflowX:"auto"},children:(0,l.jsxs)("table",{children:[(0,l.jsx)("thead",{children:(0,l.jsx)("tr",{children:Y.headers.map((e=>(0,l.jsx)("th",{children:e},e)))})}),(0,l.jsx)("tbody",{children:Y.sampleRows.slice(0,10).map(((e,t)=>(0,l.jsx)("tr",{children:Y.headers.map((t=>(0,l.jsx)("td",{children:e[t]||"-"},t)))},t)))})]})}):(0,l.jsx)("p",{children:"No data preview yet."})]}),(0,l.jsxs)("section",{className:"card padding--md margin-bottom--lg",children:[(0,l.jsx)("h3",{children:"AI Insights"}),L&&(0,l.jsx)("p",{style:{color:"var(--ifm-color-danger)"},children:L}),P&&(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Summary:"})," ",P]}),M.length>0&&(0,l.jsx)("ul",{children:M.map(((e,t)=>(0,l.jsx)("li",{children:e},t)))})]}),(0,l.jsxs)("section",{className:"card padding--md margin-bottom--lg",style:{minHeight:"420px"},children:[(0,l.jsx)("h3",{children:"Interactive chart"}),W&&(0,l.jsx)("p",{style:{color:"var(--ifm-color-danger)"},children:W}),(0,l.jsx)("div",{style:{minHeight:"360px"},children:(0,l.jsx)("div",{ref:$,style:{width:"100%",minHeight:"420px",height:"420px"}})}),(0,l.jsx)("div",{className:"margin-top--sm",children:(0,l.jsx)("button",{className:"button button--secondary button--sm",onClick:function(){if(!F.current)return;const e=F.current.getDataURL({type:"png",pixelRatio:2,backgroundColor:"#ffffff"}),t=document.createElement("a");t.href=e,t.download=`ai-chart-${Date.now()}.png`,t.click()},disabled:!q,children:"Download PNG"})})]}),(0,l.jsxs)("section",{className:"card padding--md",children:[(0,l.jsx)("h3",{children:"Raw AI response"}),(0,l.jsx)("pre",{style:{maxHeight:"320px",overflow:"auto"},children:J||"No response yet."})]})]})]}),(0,l.jsx)(o.A,{})]})})}},95082:(e,t,r)=>{r.d(t,{b:()=>s});var n=r(51270);let a=null;function s(){if(a)return a;if("undefined"==typeof window)return null;const e=window.__SUPABASE_URL__,t=window.__SUPABASE_ANON_KEY__;return e&&t?(a=(0,n.UU)(e,t,{auth:{persistSession:!0,autoRefreshToken:!0}}),a):null}}}]);