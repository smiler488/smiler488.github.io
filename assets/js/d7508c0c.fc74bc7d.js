"use strict";(self.webpackChunkliangchao_website=self.webpackChunkliangchao_website||[]).push([[4035],{6506:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var r=n(6540),a=n(1656),i=n(5260),o=n(4848);function s(e){return Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join("")}function l(e){if(!e)return new Uint8Array;const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++)t[n]=parseInt(e.substr(2*n,2),16);return t.buffer}async function d(e,t){const n=l(t),r=(new TextEncoder).encode(e),a=await window.crypto.subtle.importKey("raw",r,"PBKDF2",!1,["deriveKey"]);return await window.crypto.subtle.deriveKey({name:"PBKDF2",salt:n,iterations:2e5,hash:"SHA-256"},a,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function c(e){const t=l(e);return window.crypto.subtle.importKey("raw",t,"AES-GCM",!1,["decrypt","encrypt"])}async function p(e,t){const n=crypto.getRandomValues(new Uint8Array(12)),r=(new TextEncoder).encode(JSON.stringify(t)),a=await crypto.subtle.encrypt({name:"AES-GCM",iv:n},e,r);return{iv:s(n.buffer),ct:(i=a,btoa(String.fromCharCode(...new Uint8Array(i))))};var i}async function y(e,t,n){const r=l(t),a=function(e){const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n.buffer}(n),i=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},e,a),o=(new TextDecoder).decode(i);return JSON.parse(o)}async function u(e,t=""){if(t&&t.length>0){const n=s(crypto.getRandomValues(new Uint8Array(16)).buffer),r=await d(t,n),a=await p(r,e),i={mode:"pw",salt:n,iv:a.iv,ct:a.ct,meta:{v:1}};return`note=${btoa(JSON.stringify(i))}`}{const t=await async function(){const e=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return s(await crypto.subtle.exportKey("raw",e))}(),n=await c(t),r=await p(n,e),a={mode:"key",iv:r.iv,ct:r.ct,meta:{v:1}};return`note=${btoa(JSON.stringify(a))}.${t}`}}function h(){const[e,t]=(0,r.useState)(""),[n,s]=(0,r.useState)(""),[l,p]=(0,r.useState)(""),[h,g]=(0,r.useState)(""),[f,b]=(0,r.useState)(!1),[w,m]=(0,r.useState)(""),[j,v]=(0,r.useState)(""),[k,S]=(0,r.useState)(null),[C,A]=(0,r.useState)(!1),[O,T]=(0,r.useState)(""),[R,I]=(0,r.useState)(null);function U(e){if(!e)return!1;if(e.expiresAtISO){const t=new Date(e.expiresAtISO);if(isNaN(t.getTime()));else if(Date.now()>t.getTime())return v("This note has expired."),!1}return!0}function G(){history.replaceState(null,"",location.pathname+location.search),I(null),S(null),v("")}function K(){return!!k&&!k.readOnly}return(0,r.useEffect)((()=>{const e=function(){const e=location.hash||"";if(!e.includes("note="))return null;const t=e.split("note=")[1];if(!t)return null;const[n,r]=t.split(".");try{return{payload:JSON.parse(atob(n)),rawKeyHex:r||null}}catch(a){return null}}();I(e),e&&("pw"===e.payload.mode?(A(!0),v("Protected note \u2014 enter password to open.")):"key"===e.payload.mode?e.rawKeyHex?(async()=>{try{const t=await c(e.rawKeyHex),n=await y(t,e.payload.iv,e.payload.ct);U(n)&&(S(n),v("Opened note from link."))}catch(t){console.error(t),v("Failed to decrypt with key from link.")}})():v("Shared link missing key \u2014 cannot open."):v("Unknown link mode."))}),[]),(0,o.jsxs)(a.A,{title:"Cloud Sticky Notes",children:[(0,o.jsx)(i.A,{children:(0,o.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})}),(0,o.jsxs)("div",{style:{maxWidth:900,margin:"28px auto",padding:"12px"},children:[(0,o.jsx)("h1",{children:"Cloud Sticky Note (static)"}),(0,o.jsx)("p",{style:{color:"#444"},children:"Create a temporary/shareable note. This zero-backend version stores the note encrypted in the URL fragment. Sharing the link allows others to open it. Use a password for higher privacy (recipient must know the password)."}),(0,o.jsxs)("div",{style:{display:"grid",gap:10,marginTop:12},children:[(0,o.jsxs)("label",{children:["Note name",(0,o.jsx)("input",{style:x.input,value:e,onChange:e=>t(e.target.value)})]}),(0,o.jsxs)("label",{children:["Content",(0,o.jsx)("textarea",{rows:8,style:x.textarea,value:n,onChange:e=>s(e.target.value)})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,o.jsxs)("label",{style:{flex:1},children:["Expires (optional)",(0,o.jsx)("input",{type:"datetime-local",style:x.input,value:l,onChange:e=>p(e.target.value)})]}),(0,o.jsxs)("label",{style:{flexBasis:200},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,o.jsx)("input",{type:"checkbox",checked:f,onChange:e=>b(e.target.checked)}),(0,o.jsx)("div",{children:"Read-only link"})]}),(0,o.jsx)("small",{style:{color:"#666"},children:"Marking read-only is advisory in static links."})]}),(0,o.jsxs)("label",{style:{flexBasis:260},children:[(0,o.jsx)("div",{children:"Protect with password (optional)"}),(0,o.jsx)("input",{style:x.input,value:h,onChange:e=>g(e.target.value),placeholder:"Optional password"}),(0,o.jsx)("small",{style:{color:"#666"},children:"If set, recipients will need the password to open the note."})]})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,o.jsx)("button",{onClick:async function(){try{v("Generating link...");const t={name:e||"Untitled",content:n||"",createdAtISO:(new Date).toISOString(),expiresAtISO:l?new Date(l).toISOString():null,readOnly:!!f},r=await u(t,h),a=`${location.origin}${location.pathname}#${r}`;m(a),v("Link generated. Copy and share.")}catch(t){console.error(t),v("Failed to generate link: "+t.message)}},style:x.btnPrimary,children:"Generate share link"}),(0,o.jsx)("button",{onClick:function(){w&&navigator.clipboard.writeText(w).then((()=>v("Link copied to clipboard."))).catch((e=>v("Copy failed: "+e.message)))},style:x.btnSecondary,disabled:!w,children:"Copy link"}),(0,o.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(n||"")},style:x.btnGhost,children:"Copy content"}),(0,o.jsx)("button",{onClick:()=>{t(""),s(""),p(""),g(""),b(!1),m(""),v("")},style:x.btnGhost,children:"Reset"})]}),w&&(0,o.jsxs)("div",{style:{background:"#f6f9ff",padding:8,borderRadius:6},children:[(0,o.jsx)("div",{style:{fontSize:13},children:"Share link (fragment)"}),(0,o.jsx)("textarea",{readOnly:!0,rows:2,style:x.shareArea,value:w})]}),(0,o.jsxs)("div",{style:{marginTop:6},children:[(0,o.jsx)("strong",{children:"Status:"})," ",j]}),(0,o.jsx)("hr",{}),(0,o.jsx)("h3",{children:"Open shared note (from URL)"}),R?(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{style:{padding:8,background:"#fff8e1",borderRadius:6},children:["Parsed shared link found in URL fragment. Mode: ",(0,o.jsx)("b",{children:R.payload.mode}),"."]}),"pw"===R.payload.mode&&(0,o.jsxs)("div",{style:{marginTop:8},children:[(0,o.jsx)("label",{children:"Enter password to open"}),(0,o.jsx)("input",{style:x.input,value:O,onChange:e=>T(e.target.value)}),(0,o.jsxs)("div",{style:{display:"flex",gap:8,marginTop:8},children:[(0,o.jsx)("button",{onClick:async function(){if(R)try{const e=await d(O,R.payload.salt),t=await y(e,R.payload.iv,R.payload.ct);if(!U(t))return;S(t),v("Opened note with password."),A(!1)}catch(e){console.error(e),v("Wrong password or decryption failed.")}},style:x.btnPrimary,children:"Open"}),(0,o.jsx)("button",{onClick:G,style:x.btnGhost,children:"Clear"})]})]}),"key"===R.payload.mode&&(0,o.jsxs)("div",{style:{marginTop:8},children:[(0,o.jsx)("div",{children:"Key present in fragment (auto-decrypt attempted)."}),(0,o.jsx)("div",{style:{display:"flex",gap:8,marginTop:8},children:(0,o.jsx)("button",{onClick:G,style:x.btnGhost,children:"Clear"})})]})]}):(0,o.jsxs)("div",{children:["No share fragment found in URL. To open a note, paste a link with ",(0,o.jsx)("code",{children:"#note=..."})," and reload."]}),k&&(0,o.jsxs)("div",{style:{marginTop:12,padding:12,borderRadius:8,background:"#f3fff6"},children:[(0,o.jsx)("h3",{children:k.name}),(0,o.jsxs)("div",{style:{color:"#666",fontSize:13},children:["Created: ",k.createdAtISO,k.expiresAtISO&&(0,o.jsxs)("span",{children:[" \xb7 Expires: ",k.expiresAtISO]}),k.readOnly&&(0,o.jsx)("span",{children:" \xb7 Read-only"})]}),(0,o.jsx)("div",{style:{marginTop:8},children:(0,o.jsx)("textarea",{style:x.textarea,rows:8,value:k.content,readOnly:!K(),onChange:e=>S({...k,content:e.target.value})})}),(0,o.jsxs)("div",{style:{display:"flex",gap:8,marginTop:10},children:[(0,o.jsx)("button",{disabled:!K(),onClick:async()=>{await async function(){if(!k)return;const e={...k,content:k.content,createdAtISO:k.createdAtISO||(new Date).toISOString()};let t="";R&&"pw"===R.payload.mode&&(t=O);const n=await u(e,t),r=`${location.origin}${location.pathname}#${n}`;m(r),v("Regenerated link for edited note. Copy to share.")}()},style:x.btnPrimary,children:"Save edits & regenerate link"}),(0,o.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(k.content||"")},style:x.btnSecondary,children:"Copy content"}),(0,o.jsx)("button",{onClick:G,style:x.btnGhost,children:"Close"})]})]})]})]})]})}const x={input:{width:"100%",padding:"8px 10px",marginTop:6,borderRadius:6,border:"1px solid #ccc"},textarea:{width:"100%",padding:"8px 10px",marginTop:6,borderRadius:6,border:"1px solid #ccc",fontFamily:"inherit"},shareArea:{width:"100%",borderRadius:6,border:"1px solid #ddd",padding:6},btnPrimary:{background:"#0ea5e9",color:"#fff",padding:"8px 12px",borderRadius:6,border:"none",cursor:"pointer"},btnSecondary:{background:"#2563eb",color:"#fff",padding:"8px 12px",borderRadius:6,border:"none",cursor:"pointer"},btnGhost:{background:"#fff",color:"#111",padding:"8px 12px",borderRadius:6,border:"1px solid #ddd",cursor:"pointer"}}}}]);