"use strict";(self.webpackChunkliangchao_website=self.webpackChunkliangchao_website||[]).push([[2597],{1851:(e,t,i)=>{i.r(t),i.d(t,{default:()=>s});var n=i(6540),a=i(1656),o=i(4848);const s=()=>{const[e,t]=(0,n.useState)({alpha:0,beta:0,gamma:0}),[i,s]=(0,n.useState)({x:0,y:0,z:0}),[l,r]=(0,n.useState)(!0),[d,c]=(0,n.useState)(null),[p,x]=(0,n.useState)(!0),[u,g]=(0,n.useState)(!1),[h,f]=(0,n.useState)(""),[m,y]=(0,n.useState)({latitude:null,longitude:null,altitude:null}),[b,j]=(0,n.useState)([]),[v,w]=(0,n.useState)(!1),S=(0,n.useRef)(null),C=(0,n.useRef)(null),z=(0,n.useRef)(null),R=e=>{if(!e||"object"!=typeof e)return!1;return Object.values(e).every((e=>"number"==typeof e&&!isNaN(e)&&isFinite(e)))},k=async()=>{if(x(!0),c(null),!(()=>{const e="DeviceOrientationEvent"in window,t="DeviceMotionEvent"in window;return!(!e&&!t&&(c("Device does not support sensor functionality"),r(!1),1))})())return void x(!1);if(await(async()=>{try{return"function"==typeof DeviceOrientationEvent.requestPermission?"granted"===await DeviceOrientationEvent.requestPermission()?(g(!0),!0):(c("Device orientation permission required for sensor functionality"),!1):(g(!0),!0)}catch(e){return c("Permission request failed: "+e.message),!1}})())try{S.current=e=>{const i={alpha:e.alpha||0,beta:e.beta||0,gamma:e.gamma||0};R(i)&&t(i)},C.current=e=>{if(e.acceleration){const t={x:e.acceleration.x||0,y:e.acceleration.y||0,z:e.acceleration.z||0};R(t)&&s(t)}},window.addEventListener("deviceorientation",S.current),window.addEventListener("devicemotion",C.current),x(!1)}catch(e){c("Sensor initialization failed: "+e.message),x(!1)}else x(!1)},M=()=>{S.current&&(window.removeEventListener("deviceorientation",S.current),S.current=null),C.current&&(window.removeEventListener("devicemotion",C.current),C.current=null)};(0,n.useEffect)((()=>(k(),z.current=M,M)),[]);const D=()=>{const{beta:t,gamma:i}=e;return Math.sqrt(t*t+i*i)},A=()=>{const{x:e,y:t,z:n}=i,a=Math.sqrt(e*e+t*t+n*n);if(0===a)return 0;return Math.acos(Math.abs(n)/a)*(180/Math.PI)},F=async()=>{if(!v){w(!0);try{const t=new Date,i=await new Promise((e=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition((t=>{const{latitude:i,longitude:n,altitude:a}=t.coords||{};e({latitude:"number"==typeof i?i:null,longitude:"number"==typeof n?n:null,altitude:"number"==typeof a?a:null})}),(()=>e({latitude:null,longitude:null,altitude:null})),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):e({latitude:null,longitude:null,altitude:null})}));y(i);const{elevation:n,azimuth:a}=((e,t,i)=>{if("number"!=typeof e||"number"!=typeof t)return{elevation:null,azimuth:null};const n=Math.PI/180,a=180/Math.PI,o=new Date(i.getTime()+6e4*i.getTimezoneOffset()),s=new Date(Date.UTC(o.getUTCFullYear(),0,1)),l=Math.floor((o-s)/864e5)+1,r=2*Math.PI*(l-81)/364,d=9.87*Math.sin(2*r)-7.53*Math.cos(r)-1.5*Math.sin(r),c=e*n,p=23.45*Math.sin(2*Math.PI/365*(284+l))*n,x=15*((60*i.getHours()+i.getMinutes()+i.getSeconds()/60+4*t+d- -i.getTimezoneOffset()/60*60)/60-12)*n,u=Math.sin(c)*Math.sin(p)+Math.cos(c)*Math.cos(p)*Math.cos(x);return{elevation:Math.asin(Math.max(-1,Math.min(1,u)))*a,azimuth:(Math.atan2(Math.sin(x),Math.cos(x)*Math.sin(c)-Math.tan(p)*Math.cos(c))*a+180+360)%360}})(i.latitude,i.longitude,t),o={leafId:h||"",timestamp:t.toISOString(),latitude:i.latitude,longitude:i.longitude,altitude:i.altitude,alpha:e.alpha,beta:e.beta,gamma:e.gamma,deviceTiltDeg:D(),leafAngleDeg:A(),sunElevationDeg:n,sunAzimuthDeg:a};j((e=>[...e,o]))}finally{w(!1)}}},I=()=>{if(!b.length)return;const e=e=>{if(null==e)return"";const t=String(e);return t.includes(",")||t.includes('"')||t.includes("\n")?'"'+t.replace(/"/g,'""')+'"':t},t=[["leafId","timestamp","latitude","longitude","altitude","alpha_deg","beta_deg","gamma_deg","deviceTilt_deg","leafAngle_deg","sunElevation_deg","sunAzimuth_deg"].join(","),...b.map((t=>[t.leafId,t.timestamp,t.latitude,t.longitude,t.altitude,t.alpha?.toFixed?.(6),t.beta?.toFixed?.(6),t.gamma?.toFixed?.(6),t.deviceTiltDeg?.toFixed?.(6),t.leafAngleDeg?.toFixed?.(6),null==t.sunElevationDeg?"":t.sunElevationDeg.toFixed(6),null==t.sunAzimuthDeg?"":t.sunAzimuthDeg.toFixed(6)].map(e).join(",")))].join("\n"),i=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(i),a=document.createElement("a");a.href=n;const o=(new Date).toISOString().replace(/[:.]/g,"-");a.download=`sensor_leaf_data_${o}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(n)};return d&&!u?(0,o.jsx)(a.A,{title:"Sensor App",children:(0,o.jsxs)("div",{className:"container",style:{padding:"20px"},children:[(0,o.jsx)("h1",{children:"Device Sensor Monitor"}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto auto auto",gap:"12px",alignItems:"center",margin:"16px 0 24px"},children:[(0,o.jsx)("input",{type:"text",placeholder:"\u8bf7\u8f93\u5165\u53f6\u7247\u7f16\u53f7",value:h,onChange:e=>f(e.target.value),style:{padding:"10px 12px",borderRadius:"8px",border:"1px solid #ced4da",fontSize:"14px"}}),(0,o.jsx)("button",{onClick:F,disabled:v,style:{padding:"10px 16px",backgroundColor:v?"#6c757d":"#20c997",color:"white",border:"none",borderRadius:"8px",cursor:v?"not-allowed":"pointer",fontWeight:"600"},children:v?"\u91c7\u96c6\u4e2d\u2026":"\u83b7\u53d6\u6570\u636e"}),(0,o.jsx)("button",{onClick:I,disabled:!b.length,style:{padding:"10px 16px",backgroundColor:b.length?"#007bff":"#6c757d",color:"white",border:"none",borderRadius:"8px",cursor:b.length?"pointer":"not-allowed",fontWeight:"600"},children:"\u5bfc\u51faCSV"}),(0,o.jsxs)("div",{style:{color:"#666",fontSize:"14px"},children:["\u5df2\u8bb0\u5f55 ",b.length," \u6761"]})]}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",marginBottom:"10px"},children:[(0,o.jsxs)("div",{style:{fontSize:"14px",color:"#555"},children:["\u6700\u8fd1\u5b9a\u4f4d\uff1a",null!=m.latitude&&null!=m.longitude?`${m.latitude.toFixed(6)}, ${m.longitude.toFixed(6)}`:"\u65e0"]}),(0,o.jsxs)("div",{style:{fontSize:"14px",color:"#555"},children:["\u6d77\u62d4\uff1a",null!=m.altitude?`${m.altitude.toFixed(2)} m`:"\u672a\u77e5"]}),(0,o.jsxs)("div",{style:{fontSize:"14px",color:"#555"},children:["\u65f6\u95f4\uff1a",(new Date).toLocaleString()]})]}),(0,o.jsxs)("div",{style:{padding:"20px",backgroundColor:"#fee",border:"1px solid #fcc",borderRadius:"8px",margin:"20px 0",color:"#c33"},children:[(0,o.jsx)("h3",{children:"Error"}),(0,o.jsx)("p",{children:d}),!l&&(0,o.jsx)("p",{children:"Please use this feature on a mobile device that supports sensors."}),(0,o.jsx)("button",{onClick:k,style:{padding:"10px 20px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",marginTop:"10px"},children:"Retry"})]})]})}):p?(0,o.jsx)(a.A,{title:"Sensor App",children:(0,o.jsxs)("div",{className:"container",style:{padding:"20px"},children:[(0,o.jsx)("h1",{children:"Device Sensor Monitor"}),(0,o.jsxs)("div",{style:{padding:"40px",textAlign:"center",backgroundColor:"#f8f9fa",borderRadius:"8px",margin:"20px 0"},children:[(0,o.jsx)("div",{style:{width:"40px",height:"40px",border:"4px solid #e3e3e3",borderTop:"4px solid #007bff",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),(0,o.jsx)("h3",{children:"Initializing Sensors..."}),(0,o.jsx)("p",{children:"Requesting device permissions and connecting sensors"})]})]})}):(0,o.jsx)(a.A,{title:"Sensor App",children:(0,o.jsxs)("div",{className:"container",style:{padding:"20px"},children:[(0,o.jsx)("h1",{children:"Device Sensor Monitor"}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px",marginBottom:"30px"},children:[(0,o.jsxs)("div",{style:{padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,o.jsx)("h3",{style:{color:"#007bff",marginBottom:"15px"},children:"Device Orientation"}),(0,o.jsxs)("div",{style:{display:"grid",gap:"10px"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)("span",{style:{fontWeight:"500"},children:"Alpha (Z-axis):"}),(0,o.jsxs)("span",{style:{backgroundColor:"#007bff",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[e.alpha.toFixed(2),"\xb0"]})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)("span",{style:{fontWeight:"500"},children:"Beta (X-axis):"}),(0,o.jsxs)("span",{style:{backgroundColor:"#28a745",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[e.beta.toFixed(2),"\xb0"]})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)("span",{style:{fontWeight:"500"},children:"Gamma (Y-axis):"}),(0,o.jsxs)("span",{style:{backgroundColor:"#ffc107",color:"black",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[e.gamma.toFixed(2),"\xb0"]})]})]})]}),(0,o.jsxs)("div",{style:{padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,o.jsx)("h3",{style:{color:"#28a745",marginBottom:"15px"},children:"Acceleration"}),(0,o.jsxs)("div",{style:{display:"grid",gap:"10px"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)("span",{style:{fontWeight:"500"},children:"X-axis:"}),(0,o.jsxs)("span",{style:{backgroundColor:"#dc3545",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[i.x.toFixed(2)," m/s\xb2"]})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)("span",{style:{fontWeight:"500"},children:"Y-axis:"}),(0,o.jsxs)("span",{style:{backgroundColor:"#17a2b8",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[i.y.toFixed(2)," m/s\xb2"]})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)("span",{style:{fontWeight:"500"},children:"Z-axis:"}),(0,o.jsxs)("span",{style:{backgroundColor:"#6f42c1",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[i.z.toFixed(2)," m/s\xb2"]})]})]})]}),(0,o.jsxs)("div",{style:{padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,o.jsx)("h3",{style:{color:"#6f42c1",marginBottom:"15px"},children:"Calculated Results"}),(0,o.jsxs)("div",{style:{display:"grid",gap:"10px"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)("span",{style:{fontWeight:"500"},children:"Device Tilt Angle:"}),(0,o.jsxs)("span",{style:{backgroundColor:"#fd7e14",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[D().toFixed(2),"\xb0"]})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)("span",{style:{fontWeight:"500"},children:"Leaf Angle:"}),(0,o.jsxs)("span",{style:{backgroundColor:"#20c997",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[A().toFixed(2),"\xb0"]})]})]})]})]}),(0,o.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",overflow:"hidden",marginTop:"30px"},children:[(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"20px",textAlign:"center"},children:[(0,o.jsx)("h2",{style:{margin:0,fontSize:"24px"},children:"Plant Leaf Angle Measurement Tutorial"}),(0,o.jsx)("p",{style:{margin:"10px 0 0",opacity:.9},children:"Using device sensors for precise plant phenotyping measurements"})]}),(0,o.jsxs)("div",{style:{padding:"30px"},children:[(0,o.jsxs)("div",{style:{marginBottom:"30px"},children:[(0,o.jsx)("h3",{style:{color:"#333",marginBottom:"20px"},children:"Measurement Steps"}),(0,o.jsx)("div",{style:{display:"grid",gap:"15px"},children:[{step:1,title:"Device Calibration",desc:"Place device on a horizontal surface to ensure stable sensor readings"},{step:2,title:"Leaf Positioning",desc:"Gently place device on target leaf surface, ensuring good contact"},{step:3,title:"Data Recording",desc:'Wait for readings to stabilize, then record the "Leaf Angle" value'},{step:4,title:"Repeat Measurements",desc:"Take 3-5 measurements of the same leaf and calculate average for accuracy"}].map((e=>(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[(0,o.jsx)("div",{style:{width:"30px",height:"30px",backgroundColor:"#007bff",color:"white",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",marginRight:"15px",flexShrink:0},children:e.step}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontWeight:"600",color:"#333",marginBottom:"5px"},children:e.title}),(0,o.jsx)("div",{style:{color:"#666",fontSize:"14px"},children:e.desc})]})]},e.step)))})]}),(0,o.jsxs)("div",{style:{marginBottom:"30px"},children:[(0,o.jsx)("h3",{style:{color:"#333",marginBottom:"20px"},children:"Calculation Formulas"}),(0,o.jsxs)("div",{style:{display:"grid",gap:"15px"},children:[(0,o.jsxs)("div",{style:{padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[(0,o.jsx)("h4",{style:{color:"#007bff",marginBottom:"10px"},children:"Leaf Inclination Angle"}),(0,o.jsx)("div",{style:{fontFamily:"monospace",fontSize:"16px",backgroundColor:"#fff",padding:"10px",borderRadius:"4px",border:"1px solid #ddd",marginBottom:"10px"},children:"\u03b8 = arccos(|az| / \u221a(ax\xb2 + ay\xb2 + az\xb2)) \xd7 (180/\u03c0)"}),(0,o.jsx)("p",{style:{margin:0,color:"#666",fontSize:"14px"},children:"Where ax, ay, az are X, Y, Z axis acceleration components respectively"})]}),(0,o.jsxs)("div",{style:{padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[(0,o.jsx)("h4",{style:{color:"#28a745",marginBottom:"10px"},children:"Device Tilt Angle"}),(0,o.jsx)("div",{style:{fontFamily:"monospace",fontSize:"16px",backgroundColor:"#fff",padding:"10px",borderRadius:"4px",border:"1px solid #ddd",marginBottom:"10px"},children:"Tilt = \u221a(\u03b2\xb2 + \u03b3\xb2)"}),(0,o.jsx)("p",{style:{margin:0,color:"#666",fontSize:"14px"},children:"Where \u03b2 is X-axis rotation angle, \u03b3 is Y-axis rotation angle"})]})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{style:{color:"#333",marginBottom:"20px"},children:"Application Scenarios"}),(0,o.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"15px"},children:[{title:"Crop Phenotyping Analysis",desc:"Measure crop leaf angle distribution to analyze photosynthetic efficiency"},{title:"Plant Growth Monitoring",desc:"Track changes in leaf angles during plant growth processes"},{title:"Variety Screening",desc:"Compare leaf angle characteristics between different plant varieties"},{title:"Environmental Response Studies",desc:"Study the effects of environmental factors on plant leaf angles"}].map(((e,t)=>(0,o.jsxs)("div",{style:{padding:"15px",backgroundColor:"#fff",borderRadius:"8px",border:"1px solid #e9ecef",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[(0,o.jsx)("h4",{style:{color:"#6f42c1",marginBottom:"8px",fontSize:"16px"},children:e.title}),(0,o.jsx)("p",{style:{margin:0,color:"#666",fontSize:"14px"},children:e.desc})]},t)))})]})]})]}),(0,o.jsx)("style",{jsx:!0,children:"\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        "})]})})}}}]);