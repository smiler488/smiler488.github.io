"use strict";(self.webpackChunkliangchao_website=self.webpackChunkliangchao_website||[]).push([[2597],{17921:(e,t,n)=>{function i(){const e="undefined"!=typeof window?window.localStorage.getItem("app_users"):null;if(!e)return[];try{return JSON.parse(e)||[]}catch{return[]}}function o(e){return Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join("")}async function a(e,t){const n=(new TextEncoder).encode(e),i=function(e){const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++)t[n]=parseInt(e.substr(2*n,2),16);return t.buffer}(t),a=await crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveBits"]);return o(await crypto.subtle.deriveBits({name:"PBKDF2",salt:i,iterations:15e4,hash:"SHA-256"},a,256))}async function r(e,t){const n=i();if(n.find((t=>t.email.toLowerCase()===String(e).toLowerCase())))throw new Error("Email already registered");const r=o(crypto.getRandomValues(new Uint8Array(16)).buffer),s=await a(t,r);return n.push({email:e,saltHex:r,hashHex:s,createdAt:(new Date).toISOString()}),function(e){"undefined"!=typeof window&&window.localStorage.setItem("app_users",JSON.stringify(e))}(n),d({email:e}),{email:e}}async function s(e,t){const n=i().find((t=>t.email.toLowerCase()===String(e).toLowerCase()));if(!n)throw new Error("Account not found");if(await a(t,n.saltHex)!==n.hashHex)throw new Error("Invalid credentials");return d({email:e}),{email:e}}function l(){if("undefined"==typeof window)return null;const e=window.localStorage.getItem("app_session");if(!e)return null;try{return JSON.parse(e)||null}catch{return null}}function d(e){"undefined"!=typeof window&&window.localStorage.setItem("app_session",JSON.stringify({email:e.email,at:Date.now()}))}function c(){"undefined"!=typeof window&&window.localStorage.removeItem("app_session")}n.d(t,{Ht:()=>l,iD:()=>s,kz:()=>r,ri:()=>c})},34619:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(96540),o=n(17921),a=n(95082),r=n(74848);function s({children:e}){const[t,n]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{const e=(0,a.b)();if(e){e.auth.getUser().then((({data:e})=>{const t=!!e?.user;n(t),"undefined"!=typeof window&&(window.__APP_AUTH_OK__=t)}));const{data:t}=e.auth.onAuthStateChange(((e,t)=>{const i=!!t?.user;n(i),"undefined"!=typeof window&&(window.__APP_AUTH_OK__=i)}));return()=>t?.subscription?.unsubscribe?.()}const t=!!(0,o.Ht)();n(t),"undefined"!=typeof window&&(window.__APP_AUTH_OK__=t)}),[]),(0,r.jsxs)("div",{children:[!t&&(0,r.jsx)("div",{className:"app-card",style:{marginBottom:12},children:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)("span",{className:"app-muted",children:"Please login to use app features"}),(0,r.jsx)("a",{className:"button button--secondary",href:"/auth",children:"Login / Register"})]})}),e]})}},61851:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var i=n(96540),o=n(63018),a=n(34619),r=n(62835),s=n(74848);function l(){return new Promise((e=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition((t=>{const{latitude:n,longitude:i,altitude:o}=t.coords||{};e({latitude:"number"==typeof n?n:null,longitude:"number"==typeof i?i:null,altitude:"number"==typeof o?o:null})}),(()=>e({latitude:null,longitude:null,altitude:null})),{enableHighAccuracy:!0,timeout:15e3,maximumAge:0}):e({latitude:null,longitude:null,altitude:null})}))}function d(e,t=6){if(null==e||Number.isNaN(e))return"";const n=Number(e);return Number.isFinite(n)?n.toFixed(t):""}function c(){const e=function(){const[e,t]=(0,i.useState)({alpha:0,beta:0,gamma:0}),n=(0,i.useRef)(null);return(0,i.useEffect)((()=>(n.current=e=>{t({alpha:"number"==typeof e.alpha?e.alpha:0,beta:"number"==typeof e.beta?e.beta:0,gamma:"number"==typeof e.gamma?e.gamma:0})},window.addEventListener("deviceorientation",n.current),()=>{n.current&&window.removeEventListener("deviceorientation",n.current)})),[]),e}(),[t,n]=(0,i.useState)(""),[c,u]=(0,i.useState)(null),[p,g]=(0,i.useState)({latitude:null,longitude:null,altitude:null}),[f,h]=(0,i.useState)([]),[m,x]=(0,i.useState)(!1),[y,b]=(0,i.useState)(null);async function w(){return await async function(){try{return"undefined"!=typeof DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?"granted"===await DeviceMotionEvent.requestPermission():"undefined"==typeof DeviceOrientationEvent||"function"!=typeof DeviceOrientationEvent.requestPermission||"granted"===await DeviceOrientationEvent.requestPermission()}catch{return!1}}()?(u("granted"),!0):(u("denied"),b("Motion permission denied. Please allow motion/orientation access."),!1)}return(0,s.jsx)(o.A,{title:"Sensor App",children:(0,s.jsxs)("div",{className:"app-container",children:[(0,s.jsxs)("div",{className:"app-header",style:{marginBottom:16},children:[(0,s.jsx)("h1",{className:"app-title",children:"Device Sensor Recorder"}),(0,s.jsx)("a",{className:"button button--secondary",href:"/docs/tutorial-apps/sensor-app-tutorial",children:"Tutorial"})]}),(0,s.jsx)(a.A,{}),(0,s.jsx)("p",{style:{color:"#555",marginTop:0},children:"Enter leaf ID, then click \u201cCapture Sample\u201d to record device orientation (alpha/beta/gamma), time, latitude/longitude/altitude, and computed solar elevation/azimuth. Export all data as CSV."}),y&&(0,s.jsx)("div",{style:{padding:12,border:"1px solid #e5e5ea",background:"#f2f2f2",color:"#333333",borderRadius:8,marginBottom:16},children:y}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto auto",gap:12,alignItems:"center",margin:"12px 0 20px"},children:[(0,s.jsx)("input",{type:"text",placeholder:"Enter leaf ID",value:t,onChange:e=>n(e.target.value),style:{padding:"10px 12px",borderRadius:8,border:"1px solid #ced4da",fontSize:14}}),(0,s.jsx)("button",{onClick:async function(){if(!m){x(!0),b(null);try{if(!await w())return void x(!1);const n=await l();g(n);const i=new Date,{elevation:o,azimuth:a}=function(e,t,n){if("number"!=typeof e||"number"!=typeof t)return{elevation:null,azimuth:null};const i=Math.PI/180,o=180/Math.PI,a=new Date(n.getTime()+6e4*n.getTimezoneOffset()),r=new Date(Date.UTC(a.getUTCFullYear(),0,1)),s=Math.floor((a-r)/864e5)+1,l=2*Math.PI*(s-81)/364,d=9.87*Math.sin(2*l)-7.53*Math.cos(l)-1.5*Math.sin(l),c=e*i,u=23.45*Math.sin(2*Math.PI/365*(284+s))*i,p=15*((60*n.getHours()+n.getMinutes()+n.getSeconds()/60+4*t+d- -n.getTimezoneOffset()/60*60)/60-12)*i,g=Math.sin(c)*Math.sin(u)+Math.cos(c)*Math.cos(u)*Math.cos(p);return{elevation:Math.asin(Math.max(-1,Math.min(1,g)))*o,azimuth:(Math.atan2(Math.sin(p),Math.cos(p)*Math.sin(c)-Math.tan(u)*Math.cos(c))*o+180+360)%360}}(n.latitude,n.longitude,i),r={leafId:t||"",timestamp:i.toISOString(),latitude:n.latitude,longitude:n.longitude,altitude:n.altitude,alpha:e.alpha,beta:e.beta,gamma:e.gamma,sunElevationDeg:o,sunAzimuthDeg:a};h((e=>[...e,r]))}catch(n){b(n?.message||String(n))}finally{x(!1)}}},disabled:m||"undefined"!=typeof window&&!window.__APP_AUTH_OK__,style:{padding:"10px 16px",backgroundColor:m?"#6c6c70":"#000000",color:"#ffffff",border:"1px solid",borderColor:m?"#6c6c70":"#000000",borderRadius:10,cursor:m?"not-allowed":"pointer",fontWeight:600},children:m?"Capturing\u2026":"Capture Sample"}),(0,s.jsx)("button",{onClick:function(){if(!f.length)return;const e=e=>{if(null==e)return"";const t=String(e);return t.includes(",")||t.includes('"')||t.includes("\n")?'"'+t.replace(/"/g,'""')+'"':t},t=[["leafId","timestamp","latitude","longitude","altitude","alpha_deg","beta_deg","gamma_deg","sunElevation_deg","sunAzimuth_deg"].join(","),...f.map((t=>[t.leafId,t.timestamp,d(t.latitude),d(t.longitude),d(t.altitude,2),d(t.alpha,6),d(t.beta,6),d(t.gamma,6),null==t.sunElevationDeg?"":Number(t.sunElevationDeg).toFixed(6),null==t.sunAzimuthDeg?"":Number(t.sunAzimuthDeg).toFixed(6)].map(e).join(",")))].join("\n"),n=new Blob([t],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(n),o=document.createElement("a"),a=(new Date).toISOString().replace(/[:.]/g,"-");o.href=i,o.download=`sensor_leaf_data_${a}.csv`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)},disabled:!f.length||"undefined"!=typeof window&&!window.__APP_AUTH_OK__,style:{padding:"10px 16px",backgroundColor:f.length?"#000000":"#6c757d",color:"white",border:"none",borderRadius:8,cursor:f.length?"pointer":"not-allowed",fontWeight:600},children:"Export CSV"})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:16,marginBottom:20},children:[(0,s.jsxs)("div",{style:{padding:16,background:"#f8f9fa",borderRadius:12},children:[(0,s.jsx)("h3",{style:{marginTop:0,color:"#000000"},children:"Current Orientation"}),(0,s.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)("span",{children:"Alpha (Z, yaw):"}),(0,s.jsxs)("strong",{children:[d(e.alpha,2),"\xb0"]})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)("span",{children:"Beta (X, pitch):"}),(0,s.jsxs)("strong",{children:[d(e.beta,2),"\xb0"]})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)("span",{children:"Gamma (Y, roll):"}),(0,s.jsxs)("strong",{children:[d(e.gamma,2),"\xb0"]})]}),(0,s.jsx)("button",{onClick:async()=>{await w()||b("Please allow motion/orientation access in browser settings.")},style:{marginTop:8,padding:"8px 12px",borderRadius:8,background:"granted"===c?"#000000":"#6c6c70",color:"#fff",border:"none",cursor:"pointer"},disabled:"undefined"!=typeof window&&!window.__APP_AUTH_OK__,children:"granted"===c?"Motion Permission Granted":"Enable Motion Permission"})]})]}),(0,s.jsxs)("div",{style:{padding:16,background:"#f8f9fa",borderRadius:12},children:[(0,s.jsx)("h3",{style:{marginTop:0,color:"#000000"},children:"Latest Geo"}),(0,s.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)("span",{children:"Latitude:"}),(0,s.jsx)("strong",{children:d(p.latitude,6)||"N/A"})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)("span",{children:"Longitude:"}),(0,s.jsx)("strong",{children:d(p.longitude,6)||"N/A"})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)("span",{children:"Altitude:"}),(0,s.jsx)("strong",{children:null==p.altitude?"N/A":d(p.altitude,2)+" m"})]}),(0,s.jsx)("button",{onClick:async()=>g(await l()),style:{marginTop:8,padding:"8px 12px",borderRadius:8,background:"#000000",color:"#ffffff",border:"1px solid #000000",cursor:"pointer"},disabled:"undefined"!=typeof window&&!window.__APP_AUTH_OK__,children:"Refresh Location"})]})]}),(0,s.jsxs)("div",{style:{padding:16,background:"#f8f9fa",borderRadius:12},children:[(0,s.jsx)("h3",{style:{marginTop:0,color:"#000000"},children:"Status"}),(0,s.jsxs)("div",{children:["Recorded rows: ",(0,s.jsx)("strong",{children:f.length})]}),(0,s.jsxs)("div",{children:["Local time: ",(0,s.jsx)("strong",{children:(new Date).toLocaleString()})]})]})]}),(0,s.jsx)("div",{style:{overflowX:"auto"},children:(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,s.jsx)("thead",{children:(0,s.jsx)("tr",{style:{background:"#f1f3f5"},children:["leafId","timestamp","latitude","longitude","altitude","alpha_deg","beta_deg","gamma_deg","sunElevation_deg","sunAzimuth_deg"].map((e=>(0,s.jsx)("th",{style:{textAlign:"left",padding:8,borderBottom:"1px solid #dee2e6"},children:e},e)))})}),(0,s.jsxs)("tbody",{children:[f.map(((e,t)=>(0,s.jsxs)("tr",{style:{borderBottom:"1px solid #f1f3f5"},children:[(0,s.jsx)("td",{style:{padding:8},children:e.leafId}),(0,s.jsx)("td",{style:{padding:8},children:e.timestamp}),(0,s.jsx)("td",{style:{padding:8},children:d(e.latitude,6)}),(0,s.jsx)("td",{style:{padding:8},children:d(e.longitude,6)}),(0,s.jsx)("td",{style:{padding:8},children:null==e.altitude?"":d(e.altitude,2)}),(0,s.jsx)("td",{style:{padding:8},children:d(e.alpha,6)}),(0,s.jsx)("td",{style:{padding:8},children:d(e.beta,6)}),(0,s.jsx)("td",{style:{padding:8},children:d(e.gamma,6)}),(0,s.jsx)("td",{style:{padding:8},children:null==e.sunElevationDeg?"":Number(e.sunElevationDeg).toFixed(6)}),(0,s.jsx)("td",{style:{padding:8},children:null==e.sunAzimuthDeg?"":Number(e.sunAzimuthDeg).toFixed(6)})]},t))),!f.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:10,style:{padding:12,color:"#666"},children:"No data yet. Enter ID and click \u201cCapture Sample\u201d."})})]})]})}),(0,s.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:12,boxShadow:"0 4px 12px rgba(0,0,0,0.08)",overflow:"hidden",marginTop:24},children:[(0,s.jsx)("div",{style:{background:"#f5f5f7",color:"#000000",padding:16},children:(0,s.jsx)("h2",{style:{margin:0,fontSize:20},children:"Solar Angle Formulas"})}),(0,s.jsxs)("div",{style:{padding:16,lineHeight:1.6,color:"#333"},children:[(0,s.jsx)("p",{style:{margin:"0 0 8px"},children:"Elevation (h) and Azimuth (A) computed in this app follow common remote-sensing approximations:"}),(0,s.jsxs)("div",{style:{fontFamily:"monospace",fontSize:14,background:"#f8f9fa",border:"1px solid #e9ecef",borderRadius:8,padding:12,marginBottom:12},children:["h = asin( sin(\u03c6)\xb7sin(\u03b4) + cos(\u03c6)\xb7cos(\u03b4)\xb7cos(H) )  [in radians]",(0,s.jsx)("br",{}),"A = atan2( sin(H),  cos(H)\xb7sin(\u03c6) \u2212 tan(\u03b4)\xb7cos(\u03c6) )  [in radians]",(0,s.jsx)("br",{}),"(degrees) = (radians) \xd7 180/\u03c0",(0,s.jsx)("br",{}),"Azimuth A is reported from North, clockwise (0..360)."]}),(0,s.jsx)("p",{style:{margin:"0 0 6px"},children:(0,s.jsx)("strong",{children:"Symbols:"})}),(0,s.jsxs)("ul",{style:{margin:0,paddingLeft:18},children:[(0,s.jsx)("li",{children:"\u03c6: geographic latitude"}),(0,s.jsx)("li",{children:"\u03b4: solar declination"}),(0,s.jsx)("li",{children:"H: hour angle (H = 15\xb0 \xd7 (solar time \u2212 12))"})]}),(0,s.jsx)("p",{style:{margin:"8px 0 0",color:"#555"},children:"Note: The implementation also includes Equation of Time (EoT) and time-zone offset to estimate apparent solar time."})]})]}),(0,s.jsx)(r.A,{})]})})}},62835:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(96540),o=n(74848);const a={maxWidth:"800px",margin:"60px auto 0",textAlign:"left",padding:"0 20px"},r={fontSize:"2rem",fontWeight:"600",marginBottom:"16px",color:"#000000"},s={fontSize:"1.1rem",color:"#333333",lineHeight:1.6,marginBottom:"16px"},l={borderLeft:"4px solid #cccccc",paddingLeft:"16px",color:"#333333",fontStyle:"italic",lineHeight:1.6,marginBottom:"16px"},d={backgroundColor:"#f6f6f7",padding:"16px",borderRadius:"12px",overflowX:"auto",border:"1px solid #e5e5e7"},c={fontSize:"1.5rem",fontWeight:"600",marginBottom:"16px",color:"#000000"};function u({containerStyle:e}){const[t,n]=(0,i.useState)(!1),[u,p]=(0,i.useState)(!1),g="LiangchaoDeng. (2025). smiler488/smiler488.github.io: Digital Plant Phenotyping Platform v25.0 (v25.0.0). Zenodo. https://doi.org/10.5281/zenodo.17544584",f="@software{Deng2025_DPPP_v25,\n  author       = {Deng, Liangchao},\n  title        = {Digital Plant Phenotyping Platform (v25.0)},\n  year         = {2025},\n  publisher    = {Zenodo},\n  doi          = {10.5281/zenodo.17544584},\n  url          = {https://doi.org/10.5281/zenodo.17544584},\n  note         = {[Computer software]}\n}";return(0,o.jsxs)("div",{style:{...a,...e},children:[(0,o.jsx)("h2",{style:r,children:"Citation"}),(0,o.jsxs)("p",{style:s,children:["If you use ",(0,o.jsx)("strong",{children:"Digital Plant Phenotyping Platform v25.0"})," or any of its applications in your research, please cite it as:"]}),(0,o.jsxs)("blockquote",{style:l,children:["LiangchaoDeng. (2025)."," ",(0,o.jsx)("em",{children:"smiler488/smiler488.github.io: Digital Plant Phenotyping Platform v25.0 (v25.0.0)"}),". Zenodo.",(0,o.jsx)("br",{}),(0,o.jsx)("a",{href:"https://doi.org/10.5281/zenodo.17544584",children:"https://doi.org/10.5281/zenodo.17544584"})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px",gap:"12px"},children:[(0,o.jsx)("button",{type:"button",onClick:async()=>{try{if("undefined"!=typeof navigator&&navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(g);else if("undefined"!=typeof document){const e=document.createElement("textarea");e.value=g,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}n(!0),setTimeout((()=>n(!1)),2e3)}catch{n(!1)}},style:{padding:"8px 16px",borderRadius:"8px",border:"1px solid #000000",backgroundColor:"#000000",color:"#ffffff",cursor:"pointer",fontSize:"0.95rem",fontWeight:500,transition:"transform 0.15s ease, background-color 0.15s ease"},onMouseOver:e=>{e.currentTarget.style.backgroundColor="#333333",e.currentTarget.style.transform="translateY(-1px)"},onMouseOut:e=>{e.currentTarget.style.backgroundColor="#000000",e.currentTarget.style.transform="translateY(0)"},children:t?"Copied!":"Copy citation"}),(0,o.jsx)("span",{style:{fontSize:"0.9rem",color:t?"#007f5f":"#6c6c70"},children:t?"Citation copied to clipboard.":"Click to copy APA citation."})]}),(0,o.jsx)("a",{href:"https://doi.org/10.5281/zenodo.17544584",style:{display:"inline-block",marginBottom:"24px"},children:(0,o.jsx)("img",{src:"https://zenodo.org/badge/DOI/10.5281/zenodo.17544584.svg",alt:"DOI badge",style:{height:"32px"}})}),(0,o.jsx)("hr",{style:{border:"none",borderTop:"1px solid #e5e5e7",marginBottom:"24px"}}),(0,o.jsx)("h3",{style:c,children:"BibTeX citation (Zotero \u2192 File \u2192 Import from Clipboard)"}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px",gap:"12px"},children:[(0,o.jsx)("button",{type:"button",onClick:async()=>{try{if("undefined"!=typeof navigator&&navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(f);else if("undefined"!=typeof document){const e=document.createElement("textarea");e.value=f,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}p(!0),setTimeout((()=>p(!1)),2e3)}catch{p(!1)}},style:{padding:"8px 16px",borderRadius:"8px",border:"1px solid #000000",backgroundColor:"#000000",color:"#ffffff",cursor:"pointer",fontSize:"0.95rem",fontWeight:500,transition:"transform 0.15s ease, background-color 0.15s ease"},onMouseOver:e=>{e.currentTarget.style.backgroundColor="#333333",e.currentTarget.style.transform="translateY(-1px)"},onMouseOut:e=>{e.currentTarget.style.backgroundColor="#000000",e.currentTarget.style.transform="translateY(0)"},children:u?"Copied!":"Copy BibTeX"}),(0,o.jsx)("span",{style:{fontSize:"0.9rem",color:u?"#007f5f":"#6c6c70"},children:u?"BibTeX copied to clipboard. Switch to Zotero and choose Import from Clipboard.":"Click to copy BibTeX to clipboard for Zotero import."})]}),(0,o.jsx)("pre",{style:d,children:(0,o.jsx)("code",{children:f})})]})}},95082:(e,t,n)=>{n.d(t,{b:()=>a});var i=n(51270);let o=null;function a(){if(o)return o;if("undefined"==typeof window)return null;const e=window.__SUPABASE_URL__,t=window.__SUPABASE_ANON_KEY__;return e&&t?(o=(0,i.UU)(e,t,{auth:{persistSession:!0,autoRefreshToken:!0}}),o):null}}}]);